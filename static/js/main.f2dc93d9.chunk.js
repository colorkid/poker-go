(this["webpackJsonppoker-go"]=this["webpackJsonppoker-go"]||[]).push([[0],{141:function(e,t,n){"use strict";n.r(t);var a,c=n(4),r=n(0),i=n(25),o=n.n(i),s=n(180),u=n(179),l=n(184),b=n(176),d=n(9),j=n(183),f=n(181),m=Object(b.a)({container:{"& .MuiInput-input":{fontSize:28,width:380}},skeleton:{transform:"none"}}),O=function(e){var t=e.setNameStory,n=e.nameStory,a=e.subscribedState,i=Object(r.useState)(""),o=Object(d.a)(i,2),s=o[0],u=o[1],l=m();Object(r.useEffect)((function(){u(n)}),[n]);return Object(c.jsx)(c.Fragment,{children:a?Object(c.jsx)("div",{className:l.container,children:Object(c.jsx)(f.a,{value:s,label:"Name of story",variant:"standard",hiddenLabel:!0,onChange:function(e){u(e.target.value)},onBlur:function(e){t(e.target.value)}})}):Object(c.jsx)(j.a,{width:294,height:80,className:l.skeleton})})},h=n(93),p=n.n(h),g=n(182);(a=new g.a).webSocketFactory=function(){return new p.a("https://poker-api.r2ls.ru/ws")},a.activate();var y={onSubscribe:function(e,t,n,c,r){a.onConnect=function(){n(),a.subscribe("/topic/room/topic-changed",(function(e){t(JSON.parse(e.body))})),a.subscribe("/topic/room/im-here",(function(){var t={name:e().user.name};y.sendUserNameMeToo(t)})),a.subscribe("/topic/room/im-here-too",(function(e){c(JSON.parse(e.body))})),a.subscribe("/topic/room/i-left",(function(e){r(JSON.parse(e.body))}))}},sendTaskName:function(e){a.publish({destination:"/app/room/topic-changed",body:JSON.stringify(e)})},sendUserName:function(e){a.publish({destination:"/app/room/im-here",body:JSON.stringify(e)})},sendUserNameMeToo:function(e){a.publish({destination:"/app/room/im-here-too",body:JSON.stringify(e)})},removeUser:function(e){a.publish({destination:"/app/room/i-left",body:JSON.stringify(e)})}},v=n(17),x=function(e){return e.board.title},N=function(e){return e.board.subscribed},S=function(){var e=Object(v.c)(x),t=Object(v.c)(N);return Object(c.jsx)(O,{setNameStory:function(e){var t={title:e};y.sendTaskName(t)},nameStory:e,subscribedState:t})},E=Object(b.a)({player:{display:"flex",width:125,flexDirection:"column",alignItems:"center",wordBreak:"break-word",marginRight:-22.5,marginLeft:-22.5,"&:nth-child(odd)":{alignSelf:"flex-end"},"&:nth-child(even)":{alignSelf:"flex-start",paddingTop:5}},body:{backgroundColor:"rgba(0, 0, 0, 0.11)",width:35,height:65,borderRadius:4},name:{fontSize:18,fontWeight:600,paddingTop:8,textAlign:"center",lineHeight:1.3,minHeight:54,display:"flex",alignItems:"center"}}),k=function(e){var t=e.name,n=e.onDoubleClickHandler,a=E();return Object(c.jsxs)("div",{className:a.player,children:[Object(c.jsx)("div",{className:a.body}),Object(c.jsx)("div",{className:a.name,onDoubleClick:n,children:t})]})},w=Object(b.a)({inputName:{minWidth:70,maxWidth:125,marginTop:12}}),T=function(e){var t=e.name,n=e.setName,a=Object(r.useState)(""),i=Object(d.a)(a,2),o=i[0],s=i[1],u=w();return Object(c.jsx)(c.Fragment,{children:t?Object(c.jsx)(k,{name:t,onDoubleClickHandler:function(){t.length&&y.removeUser({name:t}),s(t),n("")}}):Object(c.jsx)(f.a,{className:u.inputName,label:"Your name",variant:"standard",value:o,onChange:function(e){s(e.target.value)},onBlur:function(){n(o)},autoFocus:!0})})},M="SET_NAME",U="PUSH_USER_NAME",C="REMOVE_USER",J=function(e){return{type:U,payload:e}},_=function(e){return{type:C,payload:e}},R=function(e){return e.user.name},A=function(){var e=Object(v.c)(R),t=Object(r.useState)(""),n=Object(d.a)(t,2),a=n[0],i=n[1],o=Object(v.b)();return Object(r.useEffect)((function(){i(e)}),[e]),Object(r.useEffect)((function(){a.length&&(o({type:M,payload:{name:a}}),y.sendUserName({name:a}))}),[a]),Object(r.useEffect)((function(){if(a.length)return function(){return y.removeUser({name:a})}}),[]),Object(c.jsx)(T,{name:a,setName:i})},F=function(e){var t=e.name;return Object(c.jsx)(k,{name:t})},H=function(e){return e.user.colleagues.filter((function(e){return e.length>0}))},I=function(){var e=Object(v.c)(H),t=Object(v.c)(R);return Object(r.useEffect)((function(){console.log(e)})),Object(c.jsx)(c.Fragment,{children:e.map((function(e){return t!==e&&Object(c.jsx)(F,{name:e},e)}))})},B=Object(b.a)({container:{display:"flex",alignItems:"center",position:"relative",height:425},table:{position:"absolute",width:"calc(100% + 80px)",height:150,display:"block",backgroundColor:"rgba(0, 0, 0, 0.11)",borderRadius:25,marginLeft:-40}}),D=function(){var e=B();return Object(c.jsxs)("div",{className:e.container,children:[Object(c.jsx)("div",{className:e.table}),Object(c.jsx)(A,{}),Object(c.jsx)(I,{})]})},G=Object(b.a)({board:{height:"100%",padding:16},header:{display:"flex"},middle:{display:"flex",justifyContent:"center",alignItems:"center",height:"calc(100vh - 137px)",padding:16},footer:{}}),L=function(){var e=G();return Object(c.jsxs)("div",{className:e.board,children:[Object(c.jsx)("header",{className:e.header,children:Object(c.jsx)(S,{})}),Object(c.jsx)("div",{className:e.middle,children:Object(c.jsx)(D,{})}),Object(c.jsx)("footer",{className:e.footer,children:"footer"})]})},W=function(){return Object(c.jsx)(L,{})},z=n(24),Y=n.n(z),q=n(57),P="GET_NAME_STORY",V="SET_SUBSCRIBE_STATE",K=function(e){return{type:P,payload:e}},Q=Object(b.a)({root:{display:"flex",flexDirection:"column",minHeight:"100vh"}}),X=function(){var e=Q(),t=Object(v.b)();return Object(r.useEffect)((function(){t(function(){var e=Object(q.a)(Y.a.mark((function e(t,n){return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y.onSubscribe(n,(function(e){return t(K(e))}),(function(){return t({type:V,payload:!0})}),(function(e){return t(J(e))}),(function(e){return t(_(e))}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}),[]),Object(c.jsx)("div",{className:e.root,children:Object(c.jsx)(W,{})})},Z=n(96),$=n(59),ee=Object(Z.a)({palette:{primary:{main:"#556cd6"},secondary:{main:"#19857b"},error:{main:$.a.A400},background:{default:"#f5f5f5"}}}),te=n(40),ne=n(95),ae=n(16),ce="GET_MESSAGE",re={allMessages:[]},ie=n(21),oe={title:"",subscribed:!1},se={name:"",colleagues:[]},ue=function(e,t){return e.colleagues.includes(t)?e:Object(ie.a)(Object(ie.a)({},e),{},{colleagues:[].concat(Object(ae.a)(e.colleagues),[t])})},le=Object(te.c)({chat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ce:return{allMessages:[].concat(Object(ae.a)(e.allMessages),[t.payload])};default:return e}},board:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case P:return Object(ie.a)(Object(ie.a)({},e),{},{title:t.payload.title});case V:return Object(ie.a)(Object(ie.a)({},e),{},{subscribed:!!t.payload});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case M:return Object(ie.a)(Object(ie.a)({},e),{},{name:t.payload.name});case U:return ue(e,t.payload.name);case C:return Object(ie.a)(Object(ie.a)({},e),{},{colleagues:e.colleagues});default:return e}}}),be=Object(te.d)(le,Object(te.a)(ne.a));o.a.render(Object(c.jsx)(u.a,{injectFirst:!0,children:Object(c.jsxs)(l.a,{theme:ee,children:[Object(c.jsx)(s.a,{}),Object(c.jsx)(v.a,{store:be,children:Object(c.jsx)(X,{})})]})}),document.querySelector("#root"))}},[[141,1,2]]]);
//# sourceMappingURL=main.f2dc93d9.chunk.js.map